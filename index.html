<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InvestAndEarnPro - Invest and Earn High Returns</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Storage utility
        const storage = {
            save: (key, data) => localStorage.setItem(key, JSON.stringify(data)),
            get: (key) => {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            }
        };

        // App State
        let state = {
            currentUser: null,
            users: storage.get('iep_users') || [{
                id: 'admin',
                email: 'admin@investandearnpro.com',
                password: 'admin123',
                name: 'Admin',
                phone: '+2348000000000',
                isAdmin: true,
                balance: 0,
                referrals: 0,
                investments: [],
                createdAt: new Date().toISOString()
            }],
            withdrawals: storage.get('iep_withdrawals') || [],
            companyAccount: storage.get('iep_company_account') || '0x1234...5678',
            showRegister: false,
            formData: {},
            errors: {}
        };

        const plans = [
            { amount: 3000, return: 30000, days: 28, color: 'from-green-400 to-emerald-600' },
            { amount: 10000, return: 100000, days: 28, color: 'from-blue-400 to-cyan-600' },
            { amount: 25000, return: 250000, days: 28, color: 'from-purple-400 to-pink-600' },
            { amount: 50000, return: 500000, days: 28, color: 'from-orange-400 to-red-600' },
            { amount: 100000, return: 1000000, days: 28, color: 'from-indigo-400 to-violet-600' }
        ];

        // Validation
        const validateEmail = (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        const validatePhone = (phone) => /^(\+234|0)[789][01]\d{8}$/.test(phone.replace(/\s/g, ''));

        // Actions
        function saveState() {
            storage.save('iep_users', state.users);
            storage.save('iep_withdrawals', state.withdrawals);
            storage.save('iep_company_account', state.companyAccount);
        }

        function handleRegister() {
            const { regName, regEmail, regPhone, regPassword, referral } = state.formData;
            const errors = {};

            if (!regName || regName.trim().length < 3) errors.name = 'Name must be at least 3 characters';
            if (!regEmail || !validateEmail(regEmail)) errors.email = 'Please enter a valid email';
            else if (state.users.some(u => u.email.toLowerCase() === regEmail.toLowerCase().trim())) {
                errors.email = 'Email already registered';
            }
            if (!regPhone || !validatePhone(regPhone)) errors.phone = 'Enter valid Nigerian number (08012345678)';
            else if (state.users.some(u => u.phone === regPhone.trim())) {
                errors.phone = 'Phone already registered';
            }
            if (!regPassword || regPassword.length < 6) errors.password = 'Password must be 6+ characters';

            if (Object.keys(errors).length > 0) {
                state.errors = errors;
                render();
                return;
            }

            const newUser = {
                id: Date.now().toString(),
                email: regEmail.toLowerCase().trim(),
                phone: regPhone.trim(),
                password: regPassword,
                name: regName.trim(),
                referredBy: referral?.trim(),
                isAdmin: false,
                balance: 0,
                referrals: 0,
                investments: [],
                createdAt: new Date().toISOString()
            };

            state.users.push(newUser);
            state.currentUser = newUser;
            state.showRegister = false;
            state.formData = {};
            state.errors = {};
            saveState();
            alert('Registration successful!');
            render();
        }

        function handleLogin() {
            const { loginEmail, loginPassword } = state.formData;
            if (!loginEmail || !loginPassword) {
                state.errors = { loginEmail: 'Enter email and password' };
                render();
                return;
            }

            const user = state.users.find(u =>
                u.email.toLowerCase() === loginEmail.toLowerCase().trim() &&
                u.password === loginPassword
            );

            if (user) {
                state.currentUser = user;
                state.formData = {};
                state.errors = {};
                render();
            } else {
                state.errors = { loginEmail: 'Invalid credentials' };
                render();
            }
        }

        function handleInvest(plan) {
            if (!state.currentUser || state.currentUser.isAdmin) return;

            state.users = state.users.map(user => {
                if (user.id === state.currentUser.id) {
                    return {
                        ...user,
                        investments: [...user.investments, {
                            plan,
                            date: new Date().toISOString(),
                            maturityDate: new Date(Date.now() + plan.days * 24 * 60 * 60 * 1000).toISOString()
                        }]
                    };
                }
                if (user.id === state.currentUser.referredBy) {
                    return { ...user, balance: user.balance + 1200, referrals: user.referrals + 1 };
                }
                return user;
            });

            state.currentUser = state.users.find(u => u.id === state.currentUser.id);
            saveState();
            alert(`Investment successful! â‚¦${plan.amount.toLocaleString()} â†’ â‚¦${plan.return.toLocaleString()} in ${plan.days} days`);
            render();
        }

        function handleWithdraw() {
            const amount = parseFloat(state.formData.withdrawAmount);
            const account = state.formData.withdrawAccount;

            if (!amount || amount <= 0 || !account || account.length < 10) {
                alert('Enter valid amount and account');
                return;
            }

            if (amount > state.currentUser.balance) {
                alert('Insufficient balance');
                return;
            }

            const withdrawal = {
                id: Date.now().toString(),
                userId: state.currentUser.id,
                userName: state.currentUser.name,
                userEmail: state.currentUser.email,
                userPhone: state.currentUser.phone,
                amount,
                account,
                date: new Date().toISOString(),
                status: 'pending'
            };

            state.withdrawals.push(withdrawal);
            state.users = state.users.map(u =>
                u.id === state.currentUser.id ? { ...u, balance: u.balance - amount } : u
            );
            state.currentUser = { ...state.currentUser, balance: state.currentUser.balance - amount };
            state.formData = {};
            saveState();
            alert('Withdrawal requested!');
            render();
        }

        function deleteUser(userId) {
            if (confirm('Delete this user?')) {
                state.users = state.users.filter(u => u.id !== userId);
                saveState();
                render();
            }
        }

        function updateCompanyAccount() {
            if (state.formData.newAccount) {
                state.companyAccount = state.formData.newAccount;
                state.formData = {};
                saveState();
                alert('Account updated!');
                render();
            }
        }

        function logout() {
            state.currentUser = null;
            state.formData = {};
            state.errors = {};
            render();
        }

        // Render functions
        function renderLoginPage() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md p-8">
                        <div class="text-center mb-8">
                            <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 text-transparent bg-clip-text">
                                InvestAndEarnPro
                            </h1>
                            <p class="text-gray-600 mt-2">Join 1,000,000+ investors</p>
                        </div>

                        ${!state.showRegister ? `
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Email</label>
                                    <input 
                                        id="loginEmail"
                                        type="email" 
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="your@email.com"
                                        value="${state.formData.loginEmail || ''}"
                                    />
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Password</label>
                                    <input 
                                        id="loginPassword"
                                        type="password" 
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="Password"
                                        value="${state.formData.loginPassword || ''}"
                                    />
                                </div>
                                ${state.errors.loginEmail ? `<p class="text-red-500 text-sm">${state.errors.loginEmail}</p>` : ''}
                                <button onclick="handleLogin()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:opacity-90">
                                    Login
                                </button>
                                <button onclick="state.showRegister = true; render();" class="w-full text-blue-600 text-sm hover:underline">
                                    Register Now
                                </button>
                            </div>
                        ` : `
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Full Name</label>
                                    <input 
                                        id="regName"
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="John Doe"
                                        value="${state.formData.regName || ''}"
                                    />
                                    ${state.errors.name ? `<p class="text-red-500 text-xs mt-1">${state.errors.name}</p>` : ''}
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Email</label>
                                    <input 
                                        id="regEmail"
                                        type="email"
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="john@example.com"
                                        value="${state.formData.regEmail || ''}"
                                    />
                                    ${state.errors.email ? `<p class="text-red-500 text-xs mt-1">${state.errors.email}</p>` : ''}
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Phone</label>
                                    <input 
                                        id="regPhone"
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="08012345678"
                                        value="${state.formData.regPhone || ''}"
                                    />
                                    ${state.errors.phone ? `<p class="text-red-500 text-xs mt-1">${state.errors.phone}</p>` : ''}
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Password</label>
                                    <input 
                                        id="regPassword"
                                        type="password"
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="Min 6 characters"
                                        value="${state.formData.regPassword || ''}"
                                    />
                                    ${state.errors.password ? `<p class="text-red-500 text-xs mt-1">${state.errors.password}</p>` : ''}
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Referral Code (Optional)</label>
                                    <input 
                                        id="referral"
                                        class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500"
                                        placeholder="Optional"
                                        value="${state.formData.referral || ''}"
                                    />
                                </div>
                                <button onclick="handleRegister()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-semibold hover:opacity-90">
                                    Register
                                </button>
                                <button onclick="state.showRegister = false; state.errors = {}; render();" class="w-full text-blue-600 text-sm hover:underline">
                                    Back to Login
                                </button>
                            </div>
                        `}
                    </div>
                </div>
            `;
        }

        function renderAdminDashboard() {
            const regularUsers = state.users.filter(u => !u.isAdmin);
            return `
                <div class="min-h-screen bg-gray-50">
                    <nav class="bg-gradient-to-r from-slate-800 to-slate-900 text-white p-4">
                        <div class="max-w-7xl mx-auto flex justify-between items-center">
                            <h1 class="text-xl md:text-2xl font-bold">âš¡ Admin Dashboard</h1>
                            <button onclick="logout()" class="flex items-center gap-2 bg-white/20 px-4 py-2 rounded-lg hover:bg-white/30">
                                Logout
                            </button>
                        </div>
                    </nav>

                    <div class="max-w-7xl mx-auto p-4 space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-2xl">
                                <p class="text-sm">Total Users</p>
                                <p class="text-4xl font-bold">${regularUsers.length}</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-2xl">
                                <p class="text-sm">Pending Withdrawals</p>
                                <p class="text-4xl font-bold">${state.withdrawals.length}</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-2xl">
                                <p class="text-sm">Total Investments</p>
                                <p class="text-4xl font-bold">${state.users.reduce((s, u) => s + u.investments.length, 0)}</p>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow p-6">
                            <h2 class="text-xl font-bold mb-4">Company Account</h2>
                            <div class="flex gap-2">
                                <input 
                                    id="newAccount"
                                    class="flex-1 px-4 py-2 border rounded-lg"
                                    value="${state.formData.newAccount !== undefined ? state.formData.newAccount : state.companyAccount}"
                                />
                                <button onclick="updateCompanyAccount()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                    Update
                                </button>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow p-6">
                            <h2 class="text-xl font-bold mb-4">Withdrawal Requests</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b">
                                            <th class="text-left p-3">User</th>
                                            <th class="text-left p-3">Contact</th>
                                            <th class="text-left p-3">Amount</th>
                                            <th class="text-left p-3">Account</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${state.withdrawals.map(w => `
                                            <tr class="border-b hover:bg-gray-50">
                                                <td class="p-3">${w.userName}</td>
                                                <td class="p-3 text-sm">${w.userEmail}<br/>${w.userPhone}</td>
                                                <td class="p-3 font-bold text-green-600">â‚¦${w.amount.toLocaleString()}</td>
                                                <td class="p-3">${w.account}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow p-6">
                            <h2 class="text-xl font-bold mb-4">All Registered Users</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b">
                                            <th class="text-left p-3">Name</th>
                                            <th class="text-left p-3">Email</th>
                                            <th class="text-left p-3">Phone</th>
                                            <th class="text-left p-3">Balance</th>
                                            <th class="text-left p-3">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${regularUsers.map(u => `
                                            <tr class="border-b hover:bg-gray-50">
                                                <td class="p-3">${u.name}</td>
                                                <td class="p-3">${u.email}</td>
                                                <td class="p-3">${u.phone}</td>
                                                <td class="p-3 font-bold text-green-600">â‚¦${u.balance.toLocaleString()}</td>
                                                <td class="p-3">
                                                    <button onclick="deleteUser('${u.id}')" class="text-red-600 hover:text-red-800 px-2 py-1">
                                                        Delete
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderUserDashboard() {
            const hour = new Date().getHours();
            const greet = hour < 12 ? 'Good Morning' : hour < 18 ? 'Good Afternoon' : 'Good Evening';
            const greeting = `${greet}, ${state.currentUser.name}!`;

            return `
                <div class="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
                    <nav class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white p-4">
                        <div class="max-w-7xl mx-auto flex justify-between items-center">
                            <h1 class="text-xl md:text-2xl font-bold">ðŸ’Ž InvestAndEarnPro</h1>
                            <button onclick="logout()" class="flex items-center gap-2 bg-white/20 px-4 py-2 rounded-xl hover:bg-white/30">
                                Logout
                            </button>
                        </div>
                    </nav>

                    <div class="max-w-7xl mx-auto p-4 space-y-6">
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8 rounded-3xl shadow-xl">
                            <h2 class="text-3xl font-bold">${greeting}</h2>
                            <p class="mt-2">Your financial freedom starts here ðŸš€</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gradient-to-br from-green-400 to-emerald-600 text-white p-6 rounded-2xl shadow-xl">
                                <p class="text-sm">Balance</p>
                                <p class="text-3xl font-bold">â‚¦${state.currentUser.balance.toLocaleString()}</p>
                            </div>
                            <div class="bg-gradient-to-br from-blue-400 to-cyan-600 text-white p-6 rounded-2xl shadow-xl">
                                <p class="text-sm">Investments</p>
                                <p class="text-3xl font-bold">${state.currentUser.investments.length}</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-400 to-pink-600 text-white p-6 rounded-2xl shadow-xl">
                                <p class="text-sm">Referrals</p>
                                <p class="text-3xl font-bold">${state.currentUser.referrals}</p>
                            </div>
                        </div>

                        <div class="bg-white rounded-3xl shadow-xl p-6">
                            <h2 class="text-2xl font-bold mb-6">Investment Plans</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                ${plans.map((plan, i) => `
                                    <div class="border-2 rounded-2xl p-6 hover:shadow-xl transition">
                                        <div class="bg-gradient-to-br ${plan.color} text-white rounded-xl p-4 mb-4 text-center">
                                            <p class="text-3xl font-bold">â‚¦${plan.amount.toLocaleString()}</p>
                                        </div>
                                        <div class="space-y-2 mb-4">
                                            <p>Returns: <span class="font-bold text-green-600">â‚¦${plan.return.toLocaleString()}</span></p>
                                            <p>Duration: <span class="font-bold">${plan.days} days</span></p>
                                            <p>ROI: <span class="font-bold text-purple-600">${((plan.return / plan.amount - 1) * 100).toFixed(0)}%</span></p>
                                        </div>
                                        <button 
                                            onclick='handleInvest(${JSON.stringify(plan)})'
                                            class="w-full bg-gradient-to-r ${plan.color} text-white py-3 rounded-xl font-semibold hover:opacity-90"
                                        >
                                            Invest Now
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-3xl p-6 text-white shadow-xl">
                                <h2 class="text-2xl font-bold mb-4">Withdraw Funds</h2>
                                <div class="space-y-4">
                                    <input 
                                        id="withdrawAmount"
                                        type="number"
                                        class="w-full px-4 py-3 rounded-xl bg-white/20 text-white placeholder-white/70"
                                        placeholder="Amount"
                                        value="${state.formData.withdrawAmount || ''}"
                                    />
                                    <input 
                                        id="withdrawAccount"
                                        class="w-full px-4 py-3 rounded-xl bg-white/20 text-white placeholder-white/70"
                                        placeholder="Account Number"
                                        value="${state.formData.withdrawAccount || ''}"
                                    />
                                    <button onclick="handleWithdraw()" class="w-full bg-white text-green-600 py-3 rounded-xl font-bold hover:bg-green-50">
                                        Request Withdrawal ðŸ’°
                                    </button>
                                </div>
                            </div>

                            <div class="bg-gradient-to-br from-purple-500 to-pink-600 rounded-3xl p-6 text-white shadow-xl">
                                <h2 class="text-2xl font-bold mb-4">Referral Program</h2>
                                <div class="bg-white/20 p-6 rounded-2xl mb-4">
                                    <p class="text-sm mb-2">Your Referral Code:</p>
                                    <p class="text-3xl font-bold break-all">${state.currentUser.id}</p>
                                    <p class="text-sm mt-2">ðŸ’° Earn â‚¦1,200 per referral!</p>
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-white/20 p-4 rounded-xl flex justify-between">
                                        <span>Total Referrals</span>
                                        <span class="font-bold text-2xl">${state.currentUser.referrals}</span>
                                    </div>
                                    <div class="bg-white/20 p-4 rounded-xl flex justify-between">
                                        <span>Earnings</span>
                                        <span class="font-bold text-2xl">â‚¦${(state.currentUser.referrals * 1200).toLocaleString()}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            
            if (!state.currentUser) {
                app.innerHTML = renderLoginPage();
                attachLoginEventListeners();
            } else if (state.currentUser.isAdmin) {
                app.innerHTML = renderAdminDashboard();
                attachAdminEventListeners();
            } else {
                app.innerHTML = renderUserDashboard();
                attachUserEventListeners();
            }
        }

        function attachLoginEventListeners() {
            const loginEmail = document.getElementById('loginEmail');
            const loginPassword = document.getElementById('loginPassword');
            const regName = document.getElementById('regName');
            const regEmail = document.getElementById('regEmail');
            const regPhone = document.getElementById('regPhone');
            const regPassword = document.getElementById('regPassword');
            const referral = document.getElementById('referral');

            if (loginEmail) loginEmail.addEventListener('input', (e) => state.formData.loginEmail = e.target.value);
            if (loginPassword) loginPassword.addEventListener('input', (e) => state.formData.loginPassword = e.target.value);
            if (regName) regName.addEventListener('input', (e) => state.formData.regName = e.target.value);
            if (regEmail) regEmail.addEventListener('input', (e) => state.formData.regEmail = e.target.value);
            if (regPhone) regPhone.addEventListener('input', (e) => state.formData.regPhone = e.target.value);
            if (regPassword) regPassword.addEventListener('input', (e) => state.formData.regPassword = e.target.value);
            if (referral) referral.addEventListener('input', (e) => state.formData.referral = e.target.value);
        }

        function attachAdminEventListeners() {
            const newAccount = document.getElementById('newAccount');
            if (newAccount) newAccount.addEventListener('input', (e) => state.formData.newAccount = e.target.value);
        }

        function attachUserEventListeners() {
            const withdrawAmount = document.getElementById('withdrawAmount');
            const withdrawAccount = document.getElementById('withdrawAccount');
            
            if (withdrawAmount) withdrawAmount.addEventListener('input', (e) => state.formData.withdrawAmount = e.target.value);
            if (withdrawAccount) withdrawAccount.addEventListener('input', (e) => state.formData.withdrawAccount = e.target.value);
        }

        // Initial render
        render();
    </script>
</body>
</html>
